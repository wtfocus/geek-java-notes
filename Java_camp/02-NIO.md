[toc]

## NIO

### 服务器通信原理

1. IP 标示一台主机

2. PORT 标示一个进程

3.  idea 启动多进程时，添加　-Xmx512，设置最大堆内存。

4. 命令行压测工具

	- windows/mac：sb (SuperBenchmarker)

		> sb -u http://localhost:8001/ -c 40 -N 30

	- linux: Apache ab

5.　BIO: Java HTTP 服务器

	1.　单线程
	2.　多线程
	3.　线程池
		- 线程池大小设置？

### 服务器通信过程分析

1.　操作分类
	1.　CPU
	2.　IO
2.　线程池大小
	1.　 线程 IO 操作时，不消耗 CPU，可以创建多于 CPU 核数的线程数量。
3.　对于一个 IO 相关应用来说，大量的 IO 会造成大部分　CPU 等资源，可能就就被浪费了。
	1.　多线程，管理成本较高。上下文切换频繁。
4.　深入一层的看问题
	1.　不仅面临线程/CPU 的问题
	2.　还要面对数据来回复制的问题。（用户空间/内核空间）

### 通信模型

1. 阻塞、非阻塞，是线程处理模式。

2. 同步、异步，是通信模式。

3. 五种 IO 模型

	1. |      | 阻塞          | 非阻塞              |
		| ---- | ------------- | ------------------- |
		| 同步 | 阻塞 I/O 模型 | 非阻塞 I/O 模型     |
		| 同步 | I/O 复用模型  | 信号驱动的 I/O 模型 |
		| 异步 |               | 异步 I/O 模型       |

4. 阻塞 I/O 模型

	1.　BIO

5.　非阻塞 I/O 模型

	1.　轮询查看数据是否准备好
	2.　类 BIO

6.　I/O 复用模型

	1.　先阻塞在　select/poll/epoll 上，（内核轮询）
	2.　再阻塞在 IO 操作上
	3.　epoll !  
	4.　Reactor 模式

7.　信号驱动的 I/O 模型

	1.　事件驱动模式
	2.　线程池 -> EDA -> SEDA

8.　异步 I/O 模型

	1.　Proactor 模式

